**Определение возраста покупателей**

Сетевой супермаркет «Хлеб-Соль» (название вымышленное) внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:

Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
Контролировать добросовестность кассиров при продаже алкоголя.

**Цель**

Необходимо построить модель, которая по фотографии определит приблизительный возраст человека. В моём распоряжении набор фотографий людей с указанием возраста.

Задачи:

- Провести исследовательский анализ набора фотографий.
- Подготовить данные к обучению.
- Обучить нейронную сеть и рассчитать её качество.
- Значение метрики MAE не должно быть выше значения: 8.

**Выводы проекта:**

Для реализации нейросети были использваны 4 функции.

1. load_train(path): Функция загружает тренировочный датасет изображений и их меток. Основные действия, выполняемые в этой функции:
   - Загрузка меток из файла labels.csv с указанным путем path.
   - Создание генератора данных (train_gen_flow) с использованием ImageDataGenerator для генерации пакетов данных изображений из директории path/final_files/.
   - Настройка параметров, таких как размер изображения, размер пакета и разделение данных на тренировочный и валидационный наборы.
   - Возвращение генератора данных train_gen_flow.
   

2. load_test(path): Функция загружает тестовый датасет изображений и их меток.


3. create_model(input_shape): Функция создает модель глубокого обучения с использованием архитектуры ResNet50 с замороженными верхними слоями. Основные действия, выполняемые в этой функции:
   - Загружается предобученная модель ResNet50 с весами imagenet с использованием ResNet50(input_shape=input_shape, weights='imagenet', include_top=False).
   - Создается Sequential модель (model), куда добавляется загруженная модель ResNet50.
   - Добавляются слои для предотвращения переобучения (Dropout) и выходной слой с одним нейроном.
   - Компилируется модель с оптимизатором Adam, функцией потерь 'mae' (Mean Absolute Error) и метрикой 'mae'.
   - Возвращается созданная модель model.


4. train_model(model, train_data, test_data, batch_size=None, epochs=20, steps_per_epoch=None, validation_steps=None): Функция тренирует модель на заданных параметрах. Основные действия, выполняемые в этой функции:
   - Используется model.fit() для тренировки модели, используя тренировочный и тестовый наборы данных (train_data и test_data).
   - Можно задать параметры, такие как размер пакета (batch_size), количество эпох (epochs), количество шагов на эпоху (steps_per_epoch) и количество шагов на валидацию (validation_steps).
   - Обученная модель возвращается.
  
**Итог:** Разработан код, который загружает датасеты с изображениями и их метками, создает модель глубокого обучения с архитектурой ResNet50, затем тренирует модель на заданных данных и параметрах. В результате активации кода получена метрика MAE на тестовой выборке 6.1991.

**Стек:**

pandas, numpy, tensorflow, seaborn
