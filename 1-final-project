# Промышленность

Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали.

# Цель:

Построить модель, которая будет предсказывать температуру стали

# Выводы проекта:

В качестве исходных данных получено 7 датафреймов с ключем - номером плавки - key. размеры массивов данных следующие:

 

| Датафрейм                                       | Размер          |Кол-во ключей     |
|:----------------------------------------------- |:---------------:|:----------------:|
| df_arc                                          | (14876, 5)      | 3214             |
| df_bulk                                         | (3129, 16)      | 3129             |
| df_bulk_t                                       | (3129, 16)      | 3129             |
| df_gas                                          | (3239, 2)       | 3239             |
| df_T                                            | (18092, 3)      | 3216             |
| df_wire                                         | (3081, 10)      | 3081             |
| df_wire_t                                       | (3081, 10)      | 3081             |

Дубликатов в данных не обнаружено. В различных датафреймах имеются пропуски.

Произведена проверка последовательности операций цикла плавки на основании данных по времени. На основаниии анализа можно сделать вывод, что для формирования целевого признака нужно брать последнюю температуру по партии. Первая температура по партии - уходит в обучающий набор признаков. Все промежуточные температуры можно удалить.

Выполнена предобработка данных. Созданы новые признаки: длительность цикла, активная длительность плаки и количество плавок в цикле, общее количество проволоки и сыпучих материалов.

Построена таблица корреляций. Сильных корреляций параметров с целевым признаком нет, однако можно выделить умеренные корреляции целевого признака с температурой первого замера, длительность плавки и подачей проволоки по первому каналу. Есть сильнокоррелирующие между собой признаки примеру Wire и b Bulk 9, они удалены в конвейере.

Вывелена гистограмма распределения параметров.

Построен конвейер, включающий в себя обработку данных и модели. Для трех различных моделей подобраны гиперпараметры. На основе их создана ансамблевая модель. Результаты кросс-валидации сведены в таблицу:

| Модель                                          | MAE             |
|:----------------------------------------------- |:---------------:|
| LightGBM                                        | 5.92            |
| XGB                                             | 5.97            |
| Ridge                                           | 6.10            |
| Ансамбль                                        | 5.82            |

Можно отметить, что различные модели выводят различные списки важности признаков, однако все из них имеют общие элементы: в качестве наиболее сильно влияющих параметров выделяется начальная температура и длительность плавки/всего цикла. Эти параметры логичны и кажутся определяющими. Важными также представляются интегральные параметры: количество проволоки и сыпучих материалов.

В качестве лучшей модели была выбрана ансамблевая модель. В нее входят три подмодели со следующими параметрами:

**LightGBM**

Лучшие гиперпараметры: {'learning_rate': 0.03610083681164567, 'max_depth': 16, 'n_estimators': 314, 'num_leaves': 12}

**XGB**

Лучшие гиперпараметры: {'learning_rate': 0.01985969904446179, 'max_depth': 3, 'n_estimators': 966}

**Ridge**

Лучшие гиперпараметры: {'alpha': 4.9062390828324824, 'solver': 'saga'}

Для всех моделей использован общий гиперпараметр *random_state=301023*.

На тестовой выборке ансамблевая модель дала следующие результаты:

| Модель                                          | MAE             |
|:----------------------------------------------- |:---------------:|
| Ансамбль                                        | 5.44            |
| Модель-заглушка                                 | 7.61            |

Ансамблевая модель отвечает требованиям заказчика относительно качества и может быть рекомендована для использования в прогнозировании конечной температуры стали.
