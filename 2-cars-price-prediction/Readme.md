**Определение стоимости автомобилей**

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение для привлечения новых клиентов. В нём можно быстро узнать рыночную стоимость своего автомобиля.

**Цель:**

- Построить модель для определения стоимости. 
- Заказчику важны: качество предсказания, скорость предсказания и время обучения.

**Выводы проекта:**

Получен изначальный массив данных размером 354369, 16.

В данных обнаружены дубликаты и пропуски. Дубликаты удалены. Пропуски обработанны по каждому признаку отдельно.

Удален ряд признаков, не несущих информацию для модели. К этому ряду относятся следующие колонки: ['DateCrawled', 'RegistrationMonth', 'DateCreated', 'NumberOfPictures', 'PostalCode', 'LastSeen']

В числовых признаках обнаружены аномальные значения. К примеру, дата регистрации машины относилась к 3500 году или мощность машины составляла 10000 л.с.

Вычленены диапазоны нормальных числовых диапазонов признаков. Не входящие в них строки удалены.

Произведена повторная проверка дубликатов после расставления заглушек. Размер нового массива данных составил 265899, 10.

Данные разделены на обучающие и целевые признаки. Создано две выборки: тренировочная и тестовая.

Для автоматизации процесса предобработки данных и обучения моделей принято решение использовать конвеер. Обучены три модели: дерева решений, случайного леса и градиентного бустинга.

Для объединения несколько моделей и получения прогноза на основе голосования или усреднения применен алгоритм ансамбля для регрессии - VotingRegressor.

Вот некоторые преимущества использования VotingRegressor:

1. Увеличение устойчивости и снижение ошибки прогнозирования: Когда разные модели имеют различные предположения или особенности, их объединение позволяет снизить смещение (bias) и дисперсию (variance) в итоговых прогнозах, что может привести к улучшению качества модели.

2. Универсальность: VotingRegressor может работать с различными типами моделей, такими как линейная регрессия, решающие деревья, градиентный бустинг и другие. Это позволяет комбинировать разнообразные модели и использовать их сильные стороны.

3. Меньшая вероятность переобучения: Объединение нескольких моделей снижает риск переобучения модели на обучающих данных.

С целью проверки произведена кросс-валидация. Получившиеся метрика удовлетворяет условию задания.

Для оценки адекватности полученных результатов применен метод сравнения с дамми-моделью. Результаты такого сравнения сведены в таблицу:

| Модель                                          | RMSE            |Время обучения модели    |
|:----------------------------------------------- |:---------------:|:-----------------------:|
| Ансамбль                                        | 1843.777        |1min 58s                 |    
| Дамми-модель                                    | 4652.324        | -                       | 

Мы получили на тестовой выборке результат, удовлетворяющий заданной точности 2500.

Объединение нескольких моделей требует больше времени для обучения и предсказания, однако ансамблевые методы дают более устойчивые предсказания. В данном случае временные затраты в 118 секунд можно считать приемлимыми.

Пути улучшения предсказания: оптимизация гиперпараметров модели методом сетевого поиска. В данном случае этот метод не использовался, так как он существенно увеличивает время счета, мы же получили удовлетворительную точность даже на базовых значениях.

**Стек:**

matplotlib, numpy, pandas, sklearn, lightgbm
